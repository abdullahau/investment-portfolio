---
title: "Stock Market Vs. Real Estate Returns (2020 - 2025)"
author: "Abdullah Mahmood"
date: last-modified
---

### Imports

```{python}

```

## Functions

```{python}

```

### Rate Periodicity Conversion

The `equivRate` function converts an interest rate from one compounding frequency to another.

$$R_{to} = n_{to} \left[ \left( 1 + \frac{R_{from}}{n_{from}} \right)^{\frac{n_{from}}{n_{to}}} - 1 \right]$$

* $R_{from}$: initial rate (`rate`)
* $n_{from}$: initial frequency (`from_freq`)
* $n_{to}$: target frequency (`to_freq`)
* $R_{to}$: equivalent rate

### Present Value (PV) Function

The `pv` function calculates the present value of an annuity and a future value, distinguishing between payments made at the beginning (`beg = True`) or end (`beg = False`) of the period.

**For payments at the end of the period (`beg = False`):**
The present value is the sum of the present values of all payments plus the present value of the future value.

$$PV = \left( \sum_{t=1}^{n} \frac{PMT}{(1+r)^t} \right) + \frac{FV}{(1+r)^n}$$

**For payments at the beginning of the period (`beg = True`):**
The payments are discounted for one less period, so the total is multiplied by $(1+r)$.

$$PV = \left[ \left( \sum_{t=1}^{n} \frac{PMT}{(1+r)^t} \right) + \frac{FV}{(1+r)^n} \right] \times (1+r)$$

* $PMT$: periodic payment (`pmt`)
* $n$: total number of periods (`n`)
* $r$: periodic interest rate (`r`)
* $FV$: future value (`fv`)

### Amortizing Loan Principal Outstanding Balance

The `principal_out` function calculates the remaining principal balance on an amortizing loan.

$$B_n = P \times \frac{(1+r)^N - (1+r)^{n-1}}{(1+r)^N - 1}$$

* $P$: initial principal balance (`P`)
* $N$: total number of payments (`N`)
* $n$: current payment number (`n`)
* $r$: periodic interest rate (`r`)
* $B_n$: outstanding balance after the $n^{th}$ payment

## Inputs

```{python}

```

### General Assumptions

* **Time Horizon:** The analysis runs from **`start_date`** (**January 1, 2020**) to **`end_date`** (**January 1, 2032**, which is 12 years after the start date). However, the evaluation of returns is conducted as of **`eval_end_date`** (**July 1, 2025**).
* **Currency Conversion:** All calculations are performed in AED as the base currency, with a fixed conversion rate of **1 USD to 3.67 AED**, as defined by **`fx_rate`**.

### Real Estate Investment

* **Property Details:** The initial property value is **`property_val`** (**510,000**).
* **Financing:**
    * **Down Payment:** A **20%** down payment is made, stored in **`down_payment`**.
    * **Loan:** The remaining **80%** is a loan, `loan_amount`, paid off over **`n_period`** (**12 years**, or 144 months) with a fixed monthly installment (`emi`) of **3,500**.
    * **Interest Rate:** The effective interest rate, `interest_rate`, is calculated to match the loan amount with the EMI payments over the loan's term.
* **Income & Growth:**
    * **Initial Annual Rent:** The property generates an initial annual rent of **`annual_rent`** (**36,000**).
    * **Rent Growth:** This rent is assumed to grow annually by **`annual_rent_gwth`** (**5%**).
    * **Property Appreciation:** The property value is assumed to appreciate annually by **`annual_appreciation`** (**5%**), with the monthly equivalent stored in **`monthly_appreciation`**.
* **Initial & Operating Costs:**
    * **Closing Costs:** A one-time expense of **`closing_costs`** (**28,000**) covers all initial fees (DLD, mortgage, commissions).
    * **Service Fees:** A one-time fee of **`service_fee`** (**7,260**) is incurred, calculated as `15 * 484`.

### Equity Market Investment

* **Investment Vehicle:** The investment is a proxy for the S&P 500, specifically the **Vanguard S&P 500 ETF (VOO)**, referenced by the ticker **`snp500`**.
* **Data Source:** The analysis uses historical data for the S&P 500 ETF from **Yahoo Finance**, stored in the **`snp500_hist`** dataframe.
* **Returns Calculation:** The historical data for the ETF's open, high, low, close, and dividends are adjusted by the fixed foreign exchange rate, **`fx_rate`**. This implies that the returns are being evaluated in the base currency (e.g., AED) after converting the U.S. dollar-denominated prices.

## Real Estate Investment

### Loan Amortization Schedule

```{python}

```

### Loan Amortization Plot

```{python}

```

### Home Equity Over Time

```{python}
```

### Performance Metrics

```{python}
```

*Note*: analysis excludes costs associated to selling/exiting of the real estate investment and the following costs incurred at the time of purchase and during the holding period:

* Rent renewal costs
* Property maintenance costs (property management fee)
* Depreciation
* Broker commission (purchase and rent)
* Registration fee
* DLD transfer fee
* Mortgage fee
* Ejari fee (incl. renewals)
* Insurance fee

## S&P 500 Investment

### S&P 500 (ETF: VOO) Price Chart

```{python}
```

```{python}
```

```{python}
```

```{python}
```

```{python}
```
